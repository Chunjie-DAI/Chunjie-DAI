+++
title = '手撕永磁同步电机数学模型'
date = 2021-01-13T22:55:31+03:00
draft = false
+++



>最近一直在做永磁同步电机（PMSM）控制相关的内容，研究到后面发现一开始的模型建立和坐标变化已经忘记很多了，回想我当初也是花了不少时间来推导这些公式方程啊，不能每次用到这些东西的时候都重新推导一遍吧😂，于是决定写一篇文章来记录推导过程，一来可以深化自己的理解，每当我忘记这些知识的时候可以很快捡起来，二来也许会对有需要的人有所帮助，我打算以尽可能通俗易懂的语言来详细描述，这里以普通的三相永磁同步电机为例，将其在ABC三相下的电压，磁链和转矩方程通过坐标变化为dq轴下的表达式，便于对其进行控制。
<!--more-->


首先先上三相绕组的坐标示意图，
![](/1630117399758.jpg)<center>Fig.1 PMSM 三相绕组示意图</center>

如上图所示，定子绕组在ABC，αβ，dq轴下的相对位置关系定义如图，α轴与A相重合，而d轴与A相的夹角为θ，dq轴以ω的同步转速在坐标系中旋转，永磁体磁链的N极与d轴重合，因此在同步电机中dq轴的旋转可以看做永磁体也就是转子的旋转，其中ω为电角速度。

根据这张图，我们首先可以列出最熟悉的ABC坐标系下的电压和磁链表达式：
![](/1630117825204.png)<center>Fig.2 电压表达式</center>

![](/1630118102615.png)<center>Fig.3 磁链表达式</center>

从电压表达式中我们可以看出，定子绕组电压主要有两部分构成，一是定子电流在绕组中由阻抗产生的损耗，通常可认为是铜损，这里我们假定电机是最常见的三相对称的，因此三相绕组线路阻抗相等，还有一部分是变化的磁链在定子绕组中产生的电动势，根据法拉第电磁感应定律，这部分电动势的大小与磁链的变化率有关，因此在电压方程右侧的第二项出现了微分。

接着我们来看磁链方程，它表示的是定子三相绕组中的磁链，来源有二，一是由定子绕组自身电流的变化而产生的与绕组自身交链的磁场，二是旋转的永磁体转子在定子绕组中的交链，显然它的幅值与永磁体和定子的相对位置有关。

接下来我对这两者进行详细说明，电感矩阵L(θ)的展开式如Fig.4，该矩阵为对称阵，对角线上元素表示同一相电流在该相线圈中产生的磁链，对应为自感L，而其它两相在该相中产生的磁链则对应为互感M，为了简化计算，假定理想情况下各相自感均相等，而互感也均相等，而实际上电感值可以表示为傅里叶级数的形式，高次项系数与夹角θ有关，3阶以及更高阶项被忽略，其实这也是书里的表达式，对其这么写的原因我还不是完全了解，在我看来电感矩阵应该与永磁体相对位置无关，而只与三相绕组间有关系，因为并不妨碍推导，这里就不继续展开了；然后是磁链方程右侧第二项，很好理解，每当转子与某一项重合时，该相将获得最大磁链。
![](/1630118407330.png)<center>Fig.4 电感矩阵</center>

为了能更好的控制PMSM，需要将三相坐标系下的方程先变化到αβ轴再变化到dq轴下，而对应的变换分别是Clark变换和Park变换，Clark变换是把三相静止坐标系变换到两相静止坐标系，Park变换则是将两相静止坐标系变成两相旋转坐标系，等效是加了一个旋转因子，涉及到的三个变换矩阵如下：
![](/1630118662701.png)<center>Fig.5 Clack变换矩阵</center>

![](/1630118757406.png)<center>Fig.6 Park变换矩阵</center>

![](/1630118811635.png)<center>Fig.7 Concordia变换矩阵</center>

其中第一个是Clark变换阵，第二个是Park变换阵，最后一个是Concordia变换阵，其实也就是正交化后的Clark阵，此时他就会满足功率不变原则，关于坐标变换的推导这里就不再详细展开了，否则内容将会过于冗长，之后也许会写文章来说明。

话收回来，有了这些变换阵我们就可以开开心心的用它们来进行坐标变换了，使用方法如下：
![](/1630119057248.png)<center>Fig.8 坐标变换</center>

f指代的是将要变化的变量，可以是电压电流等，使用T32可以将三相坐标系下的方程变为αβ坐标系下（这里忽略了零序分量），之后通过Park变成旋转的正交坐标系，具体方程如下：

**磁链方程**
首先从磁链方程开始，改写将要变换的变量，
![](/1630120365970.png)
![](/1630120436009.png)

该式中将原本三相的磁链方程最后一项进行了改写，以便于进行之后的坐标变换，可自行验证，接着左乘T32的转置，得到二阶单位阵，电感阵可得到对角化，

下一步进行Park变换的变量替代，
![](/1630124580847.png)
![](/1630124609058.png)

同样的左乘P(θ)的逆，即为P(-θ)，由此得到dq轴的磁链表达式

**电压方程**
然后是电压方程，同样改写变量，
![](/1630124632436.png)

同样左乘T32的转置
![](/1630124684707.png)

再是Park变换
![](/1630124704571.png)

同样的左乘P(θ)的逆，这里需要小心微分运算法则
![](/1630124720085.png)

最后将我们已经得到的dq轴磁链表达式代入就行了
![](/1630124738247.png)

**转矩方程**
转矩方程的表示式为磁链和电流的叉乘再乘以极对数，具体是由有功功率表达式除以机械角速度得到的，可以参考这篇文章：[如何快速理解永磁同步电机？](https://zhuanlan.zhihu.com/p/45757542)，说的十分深入浅出，总之我们把转矩表达式拿过来，得到
![](/1630124771667.png)

代入已经得到的磁链和电压表达式后
![](/1630124979049.png)

至此dq坐标系下的磁链，电压和转矩方程我们都已经得到，数学描述基本完成。

- PS：这篇文章算是我第一篇认真总结的文章，写的我十分难受，原本打算用markdown中的mathjax来写数学公式，网上了解了一下，配置麻烦不说，即便弄好了也会有各种小问题，这对于我这种不懂前端的人简直要命，markdown写公式显然没有mathtype加Word高效，于是乎改用图片表示公式。另外本人对于markdown写作还不是很熟悉，小BUG层出不穷，看来还需要继续努力啊😂

🐟🐟🐟